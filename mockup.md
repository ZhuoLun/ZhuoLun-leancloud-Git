# mockupè¯´æ˜æ–‡æ¡£

##æ¦‚è¦
```
    * é…hostï¼Œå¯å‚è€ƒæˆ‘ä¸Šæ¬¡ç¾¤é‡Œå‘çš„é‚£ä¸ªã€‚
    HOSTSæ–‡ä»¶åŠ ä¸€ä¸ªæœ¬åœ°æ˜ å°„  ===ã€‹  127.0.0.1 local-newapi.ddicar.com

    * å¯åŠ¨UIæœåŠ¡
    ç»ˆç«¯åˆ‡æ¢åˆ°é¡¹ç›®æ ¹ç›®å½•ã€‚æ‰§è¡Œ ===ã€‹ NODE_ENV=local npm start
    apiBaseå˜ä¸ºlocal-newapi.ddicar...
    localä¸ªæ€§åŒ–ä½äº =ã€‹ platform-ui-v3/config.jsonã€mock-api script

    * å¯åŠ¨APIæœåŠ¡
    ç„¶åå®šä½åˆ°ç»ˆç«¯çª—å£å¿«æ·é”® âŒ˜ + N æ¥æ–°å¼€ç»ˆç«¯çª—å£ã€‚ä¸¤ä¸ªçª—å£ï¼Œä¸€ä¸ªæŸ¥çœ‹ä»£ç†æ—¥å¿—ï¼Œä¸€ä¸ªæŸ¥çœ‹UIæ—¥å¿—ã€‚
    è¿æ¥æµ‹è¯•æœåŠ¡å™¨ã€stagingã€‘æ‰§è¡Œï¼š npm run mock-api
    è¿æ¥å…¶ä»–åŒäº‹æœºå™¨ æ‰§è¡Œï¼š./node_modules/.bin/mockup-server -x http://åŒäº‹IP:4080ã€è¿™æ¡å‘½ä»¤å·²å®æµ‹ã€‘

    [è¿™é‡Œä¸æŒ‡å®šç«¯å£ä¼šé»˜è®¤å»è¯·æ±‚httpsçš„443ç«¯å£ï¼Œä¼šæŠ¥connect ECONNREFUSED ip:443 è¿™ç±»çš„é”™è¯¯ã€‚mockçš„ä¼šæŠ¥80çš„é”™ã€‚æœ¬åœ°å±€åŸŸç½‘å’Œåç«¯è¿è°ƒè¿˜æ˜¯ä¸è¦èµ°httpsã€‚å¦åˆ™v3/api/ä¸‹çš„è¯·æ±‚éƒ½ä¼šæŠ¥404, mockæ—¥å¿—æŠ¥socket hang upã€‚]
    [æ­¤æ–¹æ³•å¯åŠ¨å¾ˆå¿«ğŸ¤£ğŸ¤—ï¼Œåªæ˜¯æ‰§è¡ŒapiåŸŸå˜æ›´æ“ä½œï¼Œä¸æ¶‰åŠUIã€‚ä¸€æ—¦å¯åŠ¨ï¼Œä¸éœ€è¦é‡å¯è¿™ä¸ªæœåŠ¡ï¼Œæ–°å»ºæ–‡ä»¶å¤¹ã€r/wæœ¬åœ°apiæ–‡ä»¶ç¥é©¬çš„ã€‚åˆ·æ–°é¡µé¢ï¼Œè‡ªåŠ¨ç”Ÿæ•ˆ]

    ***
    ç›®å‰å‘ç°çš„ å¸¸è§ httpçŠ¶æ€ç 
    200 OK  ==> æœåŠ¡å™¨æˆåŠŸå¤„ç†äº†è¯·æ±‚ï¼ˆè¿™ä¸ªæ˜¯æˆ‘ä»¬è§åˆ°æœ€å¤šçš„ï¼‰
    204 No Content  ==>  å“åº”ä¸­åŒ…å«ä¸€äº›å“åº”å¤´å’Œä¸€ä¸ªçŠ¶æ€è¡Œï¼Œä¸å­˜åœ¨æ¶ˆæ¯ä¸»ä½“ã€‚
    304 Not Modified ==> å°±æ˜¯è¯´è¦å®¢æˆ·ç«¯ä½¿ç”¨ç¼“å­˜ã€‚å½“å‰å®¢æˆ·ç«¯çš„ç¼“å­˜èµ„æºæ˜¯æœ€æ–°çš„
    400 Bad Request ==>  å‘Šè¯‰å®¢æˆ·ç«¯ï¼Œå®ƒå‘é€äº†ä¸€ä¸ªé”™è¯¯çš„è¯·æ±‚ã€‚
    401 Unauthorized ==>   éœ€è¦å®¢æˆ·ç«¯å¯¹è‡ªå·±è®¤è¯[æˆæƒ]
    403 Forbidden ==>  è¯·æ±‚è¢«æœåŠ¡å™¨æ‹’ç»äº†
    404 Not Found ==> æœªæ‰¾åˆ°èµ„æº,è¯·æ±‚äº†ä¸€ä¸ªæœåŠ¡ç«¯æ²¡æœ‰çš„ä¸çŸ¥é“ç¥é©¬çš„ä¸œè¥¿ã€‚
    409 Conflict ==>  å‘å‡ºçš„è¯·æ±‚åœ¨èµ„æºä¸Šé€ æˆäº†ä¸€äº›å†²çª
    5xx ==> æœåŠ¡ç«¯ã€apiæˆ–è€…nginxã€‘æ— æ³•å¤„ç†ï¼Œå®Œåå°±æŠ›å‡ºé”™è¯¯ï¼Œå°±æ˜¯æ— æ³•å¯¹å®¢æˆ·ç«¯å‘èµ·çš„è¯·æ±‚æä¾›æœåŠ¡çš„æ„æ€ï¼ŒæœåŠ¡å™¨çœ‹ä¸æ‡‚è¯·æ±‚ã€‚
    å¸¸è§çš„502è¡¨ç¤ºä»£ç†æœåŠ¡å™¨é‡åˆ°äº†ä¸Šæ¸¸çš„æ— æ•ˆå“åº”, æ— æ•ˆå“åº”æ„å‘³ç€é‡è¯•è¿‡åçš„è¶…æ—¶ã€‚
```

---

## è¯¦ç»†è¯´æ˜

##### è¯·åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ  `./node_modules/.bin/mockup-server` çš„ç›¸å…³å‘½ä»¤ã€‚
---

#### å‘½ä»¤è¡Œå‚æ•°çš„ç”¨æ³•

 > `-p, --port` ->   ***[å­—ç¬¦ä¸²ç±»å‹]***      æœ¬åœ°æœåŠ¡ç›‘å¬ç«¯å£   [é»˜è®¤: 4080]

 > `-o, --origin` ->   è¿™ä¸ªä¸»è¦æ˜¯çªç ´æµè§ˆå™¨çš„é™åˆ¶ã€‚ä»¥ä¾¿å¯ä»¥ä»è„šæœ¬å†…å‘èµ·è·¨åŸŸçš„HTTPè¯·æ±‚ã€‚ä½¿ç”¨è¯·æ±‚å¤´é‡Œé¢çš„ Origin å’Œ æœåŠ¡ç«¯å“åº”å¤´çš„ Access-Control-Allow-Origin æ¥å®Œæˆæœ€ç®€å•çš„è®¿é—®æ§åˆ¶ã€‚æ˜Ÿå·è¡¨ç¤ºå…è®¸æ¥è‡ªå„ç§åŸŸçš„å„ç§æ— è¯­è¯·æ±‚çš„è®¿é—®ä¸å—é™åˆ¶ã€‚ [é»˜è®¤: "*"]

 > `-b, --base` ->   ç”¨äºå®šä½APIæ–‡ä»¶æ‰€åœ¨çš„æ ¹ç›®å½•ã€‚ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½• => process.cwd() [é»˜è®¤APIæ–‡ä»¶å¤¹æ ¹ç›®å½•åç§°ä¸º "mockup-data"]

 > `-c, --context` ->   ***[å­—ç¬¦ä¸²ç±»å‹]***      APIä¸Šä¸‹æ–‡    [é»˜è®¤å€¼: ""]
 >
 > >  _æ¯”å¦‚è¯¥å‚æ•°å€¼æ˜¯ mock , å¹¶ä¸”è¯·æ±‚è·¯å¾„æ˜¯ /mock/foo/bar.jsonã€‚é‚£ä¹ˆæœåŠ¡å™¨å°±ä¼šå®šä½åˆ°apiæ–‡ä»¶å¤¹é‡Œé¢ã€Œ-b å¯¹åº”çš„ç›®å½•ã€çš„ "foo/bar.json" è¿™ä¸ªjsonæ–‡ä»¶ã€‚_
 > >>>> å¤šè¯´ä¸€å¥ã€‚è¿˜æ˜¯åœ¨apiæ ¹ç›®å½•mkdir -p /v3/api æ¯”è¾ƒå¥½ã€‚å› ä¸ºå¦‚æœå¯åŠ¨å‚æ•°æ·»åŠ äº†-c '/v3/api' è¿™ä¸ªä¸œè¥¿ã€‚é‚£ä¹‹å‰æ¯”å¦‚æµ‹æœå·²æœ‰çš„å‚æ•°æ¥å£çš„è·¯å¾„å°±ä¹±å•¦ã€‚

 > `-f, --fallback` ->  ***[å­—ç¬¦ä¸²ç±»å‹]***   è¯·æ±‚è·¯å¾„ä¸­å‡ºç°ä¸åŒ¹é…èŠ‚ç‚¹çš„çš„é™çº§è§£å†³æ–¹æ¡ˆã€‚[é»˜è®¤æ˜¯â€œ_â€]ã€‚   å¦‚æœè·¯å¾„ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹åŒ¹é…ä¸åˆ°ï¼Œé‚£ä¹ˆmockæœåŠ¡ä¼šè‡ªåŠ¨å°†è¿™ä¸ªä¸å­˜åœ¨èŠ‚ç‚¹çš„åå­—æ›¿æ¢ä¸º -f å‚æ•°æŒ‡å®šçš„åç§°ã€fallback nameã€‘ã€‚ç„¶åä¼šåœ¨apiæ–‡ä»¶å¤¹ã€é»˜è®¤æ˜¯mockup-dataã€‘é‡Œå°è¯•å»å®šä½æ–‡ä»¶ï¼Œçœ‹çœ‹æ›¿æ¢åçš„æ–‡ä»¶è·¯å¾„æ˜¯å¦å­˜åœ¨ã€‚
 >
 > > _e.g.æ¯”å¦‚è¯·æ±‚"/foo/wuyu/bar.json"å‘ç°`wuyu`è¿™ä¸ªæ–‡ä»¶å¤¹ä¸å­˜åœ¨ï¼Œè¿™é‡Œå°†ä¼šå»è‡ªåŠ¨è¯·æ±‚/foo/\_/bar.jsonè¿™ä¸ªæ–‡ä»¶ã€‚å¦‚æœ/foo/\_/bar.jsonä¹Ÿæ‰¾ä¸åˆ°ï¼Œç„¶åå‘¢ï¼Ÿé‚£å°±æ²¡æœ‰ç„¶åå•¦ã€‚ğŸ˜’_
 >
 > `-e, --enable-query` -> ***[å¸ƒå°”å€¼ç±»å‹]*** æ˜¯å¦æ¥å—æ¥è‡ªè¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€querystringã€‘ é»˜è®¤ä¸å…è®¸
 >
 > å¦‚æœæ­¤å¤„è®¾ä¸ºå…è®¸ï¼Œä¸¾ä¸ªğŸŒ°ï¼Œ"/foo/bar.json?a=1&b=2" è¿™ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²å°†ä¼šè¢«å¤„ç†å¹¶å®šä½åˆ° apiç›®å½•ä¸­çš„"foo/bar/a=1&b=2.json" è¿™ä¸ªæ–‡ä»¶ä¸Šã€‚å¦åˆ™urlæŸ¥è¯¢æ— æ•ˆ, ä¼šè¢«å¿½ç•¥ã€‚
 >
 > `-i, --ignore-queries` -> ***[é»˜è®¤ç©ºæ•°ç»„]***  å°†æŒ‰ç…§ è¯·æ±‚urlä¸­ æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°çš„åå­— æ¥è¿›è¡Œå¿½ç•¥ï¼Œå‚æ•°åå­—ç”¨ç©ºæ ¼åˆ†å¼€ã€‚
 >
 > `-t, --content-type` -> ***[å­—ç¬¦ä¸²ç±»å‹]***  è¿™é‡Œæ˜¯è®¾ç½®httpå“åº”å¤´é‡Œé¢çš„content-typeå®ä½“å¤´éƒ¨ã€‚ æ˜¯è¦å‘Šè¯‰æ¥æ”¶çš„ä¸€æ–¹ï¼Œå®é™…è¿”å›æ•°æ®çš„å†…å®¹ç±»å‹æ˜¯ä»€ä¹ˆï¼Œéœ€è¦ç”¨ä»€ä¹ˆæ–¹å¼å»å¤„ç†è¿™ç§ç±»å‹çš„æ•°æ®å†…å®¹ã€media-typeã€charsetã€boundaryã€‘ã€‚é»˜è®¤è¯·æ±‚å¤´ä¸º"application/json; charset=utf-8"ã€‚
 >
 > `-x, --proxy-host` ->  æœªå‘½ä¸­çš„è¯·æ±‚ã€miss matched requestã€‘å°†è¢«ä»£ç†åˆ°ä»£ç†ä¸»æœºã€‚å¤šä¸ªä¸»æœºåï¼Œç”¨ç©ºæ ¼åˆ†å¼€ã€‚
 >
 > é»˜è®¤çš„mock-apiå¯åŠ¨å‚æ•°é‡Œé¢å®šä¹‰çš„æ˜¯å»è¿æ¥æµ‹è¯•æœåŠ¡å™¨ã€stagingã€‘ã€‚å¦‚æœå’Œå±€åŸŸç½‘backendè¿è·³ã€‚-x ip:4080
 >
 >>> ä¸¾ä¸ªğŸŒ°è¯´ä¸‹ã€‚
 >>>
 >>> proxy - 304 - http://192.168.3.38:4080 - GET - http://local-newapi.ddicar.com:4080/v3/api/transport_reports?date_range=2017-06-01T00%3A00%3A00%2B08%3A00%2C2017-06-19T23%3A59%3A59%2B08%3A00&page=1&limit=20
 >>> ğŸ‘†  ä¸Šé¢è¿™ä¸ªè¡¨ç¤ºå®¢æˆ·ç«¯è¢«ä»£ç†åˆ°192.168.3.38è¿™ä¸ªä»£ç†æœåŠ¡å™¨ä¸Šé¢ã€‚ä»£ç†æœåŠ¡å™¨çš„åŠŸèƒ½å„æœ‰ä¸åŒã€‚ç›®å‰backendä¼šåœ¨æœ¬åœ°æ„å»ºæ•°æ®åº“å’ŒæœåŠ¡ä¾›uiè®¿é—®ï¼Œå·²ç»ç®—ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„æœåŠ¡ç«¯ã€‚
 >>> ******
 >>> 204 - 0ms - OPTIONS - http://local-newapi.ddicar.com:4080/v3/api/wuyu -
 >>> 200 - 0ms - GET - http://local-newapi.ddicar.com:4080/v3/api/wuyu - /Users/songzhuolun/å·¥ä½œåº“/DDicar/platform-ui-v3/mockup-data/v3/api/wuyu
 >>> ğŸ‘†  ä¸Šé¢è¿™ä¸ªæ˜¯è¯´æˆ‘è¯·æ±‚ api/wuyuã€‚ä½†æ˜¯ä»£ç†æœåŠ¡æä¸äº†ã€‚æ‰€ä»¥å°±è¯»åˆ°äº†æœ¬åœ°çš„APIæ–‡ä»¶å¤¹é‡Œé¢çš„å¯¹åº”æ–‡ä»¶ã€‚ç„¶åè¿”å›200ã€‚ã€æœ¬åœ°æ¨¡æ‹Ÿäº†è¯·æ±‚è¿”å›çš„æŠ¥æ–‡ã€‘

 >
 > `-h, --help` -> å¸®åŠ©
 >
 > `-v, --version` -> æŸ¥çœ‹ç‰ˆæœ¬

 ***
 ---
 >  å¦‚æœè¯·æ±‚ä½“çš„ç±»å‹[type/method]ä¸æ˜¯`GET`ã€‚mockupæœåŠ¡ä¼šä¼˜å…ˆå°è¯•å®šä½åˆ°apiæ–‡ä»¶å¤¹é‡Œçš„å¸¦è¯·æ±‚ç±»å‹*ã€Œæ¯”å¦‚GETï¼ˆSELECTï¼‰ã€POSTï¼ˆCREATEï¼‰ã€PUTï¼ˆUPDATEï¼‰ã€PATCHï¼ˆUPDATEï¼‰ã€DELETEï¼ˆDELETEï¼‰ã€HEADï¼ˆè·å–èµ„æºçš„å…ƒæ•°æ®ï¼‰ã€OPTIONSï¼ˆè·å–ä¿¡æ¯ï¼Œå…³äºèµ„æºçš„å“ªäº›å±æ€§æ˜¯å®¢æˆ·ç«¯å¯ä»¥æ”¹å˜çš„ï¼‰ç­‰ç­‰ã€*åç¼€çš„æ–‡ä»¶ä¸Šã€‚è¿™é‡Œå¤šå” å¨ä¸€å¥ï¼Œè¯·æ±‚è²Œä¼¼éƒ½æ˜¯è·¨åŸŸçš„ï¼Œå…ˆoptionæ¢è·¯ï¼Œç„¶åget/postå¤§å†›åé¢å†è·Ÿä¸Šã€‚
 >  `mockupé»˜è®¤æ”¯æŒGET,HEAD,PUT,PATCH,POST,DELETE`
 >
 > ä¸¾ä¸ªğŸŒ°ï½ ğŸ‘€
 >
 > æ¯”å¦‚è¯·æ±‚ç±»å‹æ˜¯`put`, è¯·æ±‚è·¯å¾„æ˜¯"/foo/bar.json"ã€‚é‚£ä¹ˆå¦‚æœAPIæ–‡ä»¶å¤¹é‡Œæœ‰â€œ/foo/bar.put.jsonâ€è¿™ä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆå°±ä¼šä¼˜å…ˆè¢«å‘½ä¸­ã€‚ å¦‚æœè¿™ä¸ªapiæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå°†é™çº§è¯·æ±‚åˆ°apiæ–‡ä»¶å¤¹é‡Œé¢çš„/foo/bar.json è¿™ä¸ªæ–‡ä»¶ä¸Šã€‚


## No picture no BB ğŸ™„

![mockæµ‹è¯•](https://github.com/ZhuoLun/ZhuoLun-leancloud-Git/blob/master/WX20170619-153407@2x.png?raw=true "mockæµ‹è¯•")
![mockæµ‹è¯•](https://github.com/ZhuoLun/ZhuoLun-leancloud-Git/blob/master/7.png?raw=true "mockæµ‹è¯•")
![mockæµ‹è¯•](https://github.com/ZhuoLun/ZhuoLun-leancloud-Git/blob/master/555.png?raw=true "mockæµ‹è¯•")
![mockæµ‹è¯•](https://github.com/ZhuoLun/ZhuoLun-leancloud-Git/blob/master/222.png?raw=true "mockæµ‹è¯•")
![mockæµ‹è¯•]( "mockæµ‹è¯•")
